{% extends "_layouts/default.njk" %}

{% block body %}
  <div class="content">
    <div class="provider">
      <div><img src="/files/{{ user.avatar}}">
        <strong>Olá,
          {{ user.name }}</strong>
      </div>
    </div>

    <strong>Olá,
      {{ user.name }}</strong>

    <p>Redefinindo senha</p>

    <form action="/redefinirSenhaPost" method="post">
      {% include "_partials/flash.njk" %}

      <input type="text" name="id" value="{{user.id}}">
      <input type="text" name="tokenid" value="{{tokenn.id}}">

      <input type="password" placeholder="Senha" name="password" id="password" required="required">
      <input type="password" placeholder="Confirme Senha" name="confirma_password" id="confirm_password" required="required">

      <button type="submit">Redefinir senha</button>
    </form>

    {% if (user.provider === true) %}
      <a href="/app/dashboard">Voltar</a>
    {% endif %}
    <a href="/" class="logout">Área de Login</a>
  </div>

  <script type="text/javascript">

    var password = document.getElementById("password"),
      confirm_password = document.getElementById("confirm_password");

    function validatePassword() {
      if (password.value != confirm_password.value) {
        confirm_password.setCustomValidity("Senhas diferentes!");
      } else {
        confirm_password.setCustomValidity('');
      }
    }

    password.onchange = validatePassword;
    confirm_password.onkeyup = validatePassword;
  </script>
{% endblock %}
